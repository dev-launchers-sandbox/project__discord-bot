---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  annotations:
    fluxcd.io/tag.platform-website: regex:^sha-*
  name: project-discord-bot
  namespace: project-discord-bot
spec:
  template:
    spec:
      $setElementOrder/containers:
      - name: project-discord-bot
      containers:
      - $setElementOrder/env:
        - name: MAIN_GUILD
        - name: DISCORD_TOKEN
        - name: METRICS_PORT
        - name: API_PORT
        - name: BACKEND_MTLS_CERT
        - name: BACKEND_MTLS_KEY
        - name: BACKEND_CA
        env:
        - name: MAIN_GUILD
          value: "711687367081328752"
        - name: DISCORD_BOT_POSTGRES_PORT
              value: "17792"
        - name: DISCORD_BOT_POSTGRES_USER
          valueFrom:
            secretKeyRef:
              name: postgres
              key: user
        - name: DISCORD_BOT_POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              name: postgres
              key: password
        - name: DISCORD_BOT_POSTGRES_HOST
          valueFrom:
            secretKeyRef:
              name: postgres
              key: hostname
        - name: DISCORD_BOT_POSTGRES_DB
          valueFrom:
            secretKeyRef:
              name: postgres
              key: db
        image: devlaunchers/project_discord-bot:1.0.3
        name: project-discord-bot
